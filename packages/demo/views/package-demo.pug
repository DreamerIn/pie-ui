include mixins
html
  head 
    meta(charset="utf-8")
    link(href="https://fonts.googleapis.com/css?family=Roboto", rel="stylesheet")
    script(src="//unpkg.com/showdown@1.9.0/dist/showdown.min.js")
    script(src="/assets/index.js", charset="utf-8")
    style. 

      html, body {
        margin-left: 0;
        --mdc-theme-primary: !{pkg.version === 'next' ? 'orange' : '#3f51b5'};
         /*padding: 0;*/
      }

      * {
        font-family: 'Roboto', sans-serif;
      }
      a {
        display: inline;
      }
      .holder{
        display: flex;
        position: relative;
        top: 50px;
        padding: 30px;

      }
      .content{
        position: relative;
        top: 50px;
        padding: 30px;
      }

      .element {
        flex: 2;
        margin-right: 100px;
      }

      .changelog-holder {
        flex: 1;
      }

    script(src=`/assets/${name}.js`, charset="utf-8")

    script(type="text/javascript", charset="utf-8"). 


      function renderChangelog(el) {

        if(el.textContent !== '') {
          var converter = new showdown.Converter();
          var html      = converter.makeHtml(el.textContent);
          el.innerHTML = html;
        }
      }

      document.addEventListener("DOMContentLoaded", () => {

        const data = !{JSON.stringify(data)};

        customElements.whenDefined('!{tagName}').then(() => {

          if(data && data.models){
            const el = '!{tagName}';
            data.models.forEach( m => {
              const n = document.querySelector(`[pie-id="${m.id}"]`); 
              n.model = m;
              const session = (!{JSON.stringify(session)} || []).find(s => s.id === m.id);

              n.session = session || {};
            });
          } else {
            console.error('no data?', data);
          }

        });
        renderChangelog( document.querySelector('.next-changelog'));
        renderChangelog( document.querySelector('.changelog'));
      });
  body 
    +top_bar(gitInfo, name, pkg.version)
    div.holder
      div.element
        | !{markup}

      div.changelog-holder
        h2 Next Changelog
        div.next-changelog
          | !{nextChangelog}
        hr/
        div.changelog
          | !{changelog}

